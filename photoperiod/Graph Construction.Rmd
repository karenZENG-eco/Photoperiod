---
title: "Graph Construction"
output: html_notebook
---

Packages
```{r}
library(ggplot2)
library(ggthemes)
library(ggrepel)


```

Data
```{r}
data <- read.csv("./graphdata.csv")

```

Save Code
```{r}

```

Global Settings
```{r}
mypalette <- c("#0072B2","#E69F00")
mysize <- 2
myshape <- 4 #cross
myalpha <- 0.2
```


Graph 1
```{r}
photo_plot1 <-
  ggplot(data, aes(x = year, y=doy, colour = photoperiod_sensitive))+
  geom_count( alpha = 0.2)+
  geom_smooth(aes(group = photoperiod_sensitive), method = "lm", se=F, size = 2, colour ="gray")+ #trendline
  geom_smooth(method = "lm", se=F, size = 1)+ #trendline
  xlab("Year")+
  ylab("Average First Flowering Day (Months)")+
  guides(color = guide_legend(title = "Photoperiod Sensitivity", reverse = TRUE))+
  scale_colour_manual(values=mypalette)+
  theme_clean()+
  theme(legend.position = "none")+
  scale_y_continuous(breaks=c(0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365),
                     labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D", 365),
                     limits = c(0, 365), position = "right",
                     sec.axis = sec_axis(~ . * 1, name = "Average First Flowering Day (days)",
                                         breaks = c(0, 100, 200, 300, 365)))+
  scale_x_continuous(breaks=c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2017), limit = c(1945, 2030))

  photo_plot1
```

